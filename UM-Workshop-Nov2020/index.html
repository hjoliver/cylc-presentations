<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Cylc 8 Nov 2020</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/hjo.css" id="theme">
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/school-book.css" id="highlight-theme">
		<style>
section {
		color: slategray;
}
code {
	 color:darkseagreen;
	 font-weight:bold;
}
span.quote {
	 color:orange;
}
span.quotebold {
	 color:darkorange;
}
	
		</style>

	</head>
	<body>
	<div class="reveal">
		 <div class="slides">

				<section>
					 <section>
							<h1>
								 Cylc 8 Project Report
							</h1>
							<h2>
									UM Workshop
									Nov 2020
							</h2>
							<p>Hilary Oliver, NIWA</p>
							<aside class="notes">
							</aside>
					</section>
			</section>

			<section>
					 <section>
							 <ul>
									 <li> recap: why Cylc 8?
									 <li> what's not changing?
									 <li> what is changing?
									 <li> when?
							 </ul>
							<aside class="notes">
							</aside>
	  			 </section>
			 </section>
	
			<section>
					 <section>
							 <h2>why is cylc<br/>
									 changing?</h2>
					 </section>
	
					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/python2-gtk.png"/>
							</div>
							<!--
							Python 2 RIP image credit: datree.io
							-->
							<aside class="notes">
							<ul>
									<li>The Cylc 7 scheduler and CLI are Python 2 based, and Python 2
									is now 10 months past EOL</li>
									<li>The Cylc 7 GUI is a Python 2 PyGTK desktop
									application, and PyGTK is obsolete - there is no Python 3
									version</li>
							</ul>
							<p>
							NOW the easiest solution (relatively speaking - given that even
							the old GUI embodies several person-years of effort) would have
							been to migrate Cylc 7 to Python 3 and migrate our existing GUIs
							to another GUI toolkit.</p>

							<p>
							BUT all stakeholders wanted more than this. Chiefly, a web UI to
							allow proper remote access and integrate with site identity
							management - which has major architectural implications.
							</p>

							<p>Further, Cylc has evolved organically over more than 10 years
							and various aspects of the system needed a serious redesign in
							order to remain fit-for-purpose into the future.
							</p>
							</aside>
					</section>

				<section>
						<div style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-20.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-19.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-18.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-17.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-16.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-15.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-14.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-13.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-12.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-11.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-10.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-9.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-8.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-7.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-6.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-5.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-4.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-3.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<!--
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-2.png" style="height:640px; border:1px solid slategray"/>
						</div>
						<div class="fragment" style="position:absolute">
								<img src="hjo/media/ubx-zoom/ubx-1.png" style="height:640px; border:1px solid slategray"/>
						</div>
						-->
						<aside class="notes">
								One of the major demands (well, far from the only
								one, but the easiest to depict here) that is pushing the limits
								wof Cylc 7  is of course the ever-increasing size of workflows.
								Here's a recent global suite off the shared repository.
						</aside>
				</section>

			</section>
	
			<section>
					 <section>
							 <h2>what's <span style="color:red">not</span><br/> changing?</h2>
					 </section>

					 <section>
					 <ul>
							 <li> no barrier between cycles
							 <span style="font-size:50%"><br/>(our original raison
									 d'etre)</span></li>
							 <li> support for Cylc 7 <code>suite.rc</code>
							 <span style="font-size:50%"><br/>(with deprecations)</span></li>
							 <li> support for Cylc 7 CLI syntax 
							 <span style="font-size:50%"><br/>(with deprecations)</span></li>
							 <li> ~all user-facing Cylc 7 functionality</br>
							 <span style="font-size:50%">(supported by tests)</span></li>
					 </ul>
					 <aside class="notes">
							 core: xtriggers, event handling, all control functionality (in
							 general terms, if not in detail or implementation)
					 </aside>
					 </section>

			 </section>

			<section>
					 <section>
							 <h2>what <span style="color:red">IS</span><br/> changing?</h2>
					 </section>

					 <section style="font-size:80%">
							<h4>what's changing (1/4)</h4>
					 <ul>
							 <li> <span class="quotebold">new architecture:</span>
							 <ul>
									 <li> <span class="quote">components:</span><u>Hub</u>,
									 <u>web UI</u>, <u>UI Server</u>, Scheduler, CLI</li>
									 <li> <span class="quote">network:</span> Protobuf, ZeroMQ, GraphQL, WebSocket</li> 
							 </ul></li>
							 <li class="fragment"><span class="quotebold"> web UI</span>
							 <ul>
									 <li> integrated "gscan"</li>
									 <li> separation of task and job states <br/>(and fewer
									 states, without loss of information)</li>
									 <li> responsive web design: from desktop to mobile</li>
									 <li> shared datastore and incremental update</li>
							 </ul></li>
						</ul>
						</section>

					 <section style="font-size:90%">
							<h4>what's changing (2/4)</h4>
					 <ul>
							 <li> <span class="quotebold">new "spawn on demand" scheduler</span>
							 <ul>
									 <li> much more efficient and scalable</li>
									 <li> no suicide triggers for path branching</li>
									 <li> no implicit prev-instance submit dependence</li>
									 <li> allows a better "window on the workflow"</li>
									 <li> no leakage of internal implementation</li>
							 </ul></li>
					 </ul>
					 <aside class="notes">
					 <p>
					 no implicit submit-dependence - solves a bunch of problems!
					 </p>
					 <p>
					 leakage: task pool, insertion, UI content
					 </p>
					 </aside>
					 </section>

					 <section>
							<h4>what's changing (3/4)</h4>

					 <ul>
							<ul>
								 <li> <code>rose suite-run+</code> migrated to Cylc
							<ul>
								 <li> <span class="quote">platforms</span> support</li>
								 <li> <span class="quote">suite install</span> (src to run-dir; job hosts)</li>
								 <li>  <span class="quote">safe suite run semantics</span>
								 <ul>
										 <li> play, pause, resume (and reflow)</li>
										 <li> new run-dir for each new install/run</li>
								 </ul></li>
						 </ul> </li>

						 <li class="fragment"> <span class="quote">terminology and filenames</span>
						 <ul>
								 <li> suite -&gt; (work)flow
								 <li> <code>suite.rc</code> -&gt; <code>flow.cylc</code>
						 </ul></li>

						</ul>
					 <aside class="notes">
							 <p>
							 rose suite-run migration: because it was compensating for a
							 deficiency of Cylc itself
							 </p>
							 <p>
							 platforms: cylc 8 understands multi-host platforms, not just
							 individual job hosts, and that has a bunch of benefits
							 </p>

							 <p>
							 cylc play etc.  In Cylc 7 if  you accidentally do a "run"
							 instead of a restart you will screw up you run directory and
							 won't be able to go back to do a restart. In Cylc 8, new run
							 commands are simpler and safer.
							 </p>
					 </aside>
	
						</section>

						<section>
							<h4>what's changing (4/4)</h4>
						<ul>
							 <li> authentication (user and job)</li>
							 <li class="fragment"> fine-grained authorization</li>
							 <li class="fragment"> migration to Python 3</li>
							 <li class="fragment"> code management: 6+ repositories (was 1)</li>
							 <li class="fragment"> packaging: <code>conda install cylc</code></li>
							 <li class="fragment"> cylc plugins</li>
							 <li class="fragment"> documentation (arggh)</li>
							 <li class="fragment"> ...</li>
					 </ul>
					 <aside class="notes">
							<ul>
									<li> authentication: users and jobs	<br/>
									user auth now integrates with site identity management

								  <li> states: OLD 13 task/job states. NEW 5 task/job states 3
									<ul>
										 <li> submitted, submit-failed, running, succeeded, failed
										 <li> waiting, preparing, expired
									</ul>
								 <li> internals: e.g. self-documenting config classes linked to
								 the user guide build
							</ul>
					 </aside>
					 </section>
		 </section>

		 <section>
				 <section>
						 <h2>Cylc web UI<br/> &amp; Cylc TUI</h2>
				 </section>
				 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/cylc-ui-demo.gif"/>
							</div>
					 </section>
  				 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/cylc-ui-1.gif"/>
							</div>
					 </section>
	
  				 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/cylc-ui-mutations.gif"/>
							</div>
					 </section>
	
					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/cylc-tui-demo.gif"/>
							</div>
					 </section>
			 </section>

		 <section>

					 <section>
							 <h2>Spawn on<br/> Demand</h2>
							 <p>(new scheduling algorithm)</p>
					 </section>

					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/cycling-1.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2b0.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2b00a.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2b000a.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2b000b.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2b.png"/>
							</div>
	
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-2.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling.png"/>
							</div>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img class="fragment" src="hjo/media/cycling-running.png"/>
							</div>
							<aside class="notes">
									<p>First a quick reminder of how Cylc manages cycling systems,
									because this is relevant to what comes next:</p>

									<p>We don't just run successive cycles one after the other.
									Instead, we take account of any real inter-cycle dependence
									and unroll the cycle loop to get <b>a single potentially
									INFINITE workflow composed of repeating tasks.</b></p>
    
									<p>An at run time you can think of this as a wavefront of active
									tasks advancing along the abstract workflow graph.</p>
							</aside>
					 </section>

					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/SoS.png"/>
							</div>
					 </section>
					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/SoD.png"/>
							</div>
							<aside class="notes">

									<p>
								 The "task pool": Python objects that represent the tasks in
								 the infinite graph that the scheduler has to be aware of at
								 this point in time.
								 </p>

								 <ul>
										<li> small suite: 4 tasks per cycle
										<li> Cylc 0-7: at least one running or waiting cycle-point
										instance of every task in the suite, PLUS all succeeded
										tasks in the current window .
										<ul>
											 <li> in this example, active tasks (green) spread of 5
											 cycle points: task pool 16 (but up to 20 or more)
										</ul>
										<li> NOTE the task pool does not populate whole cycles! and
										it is near impossible for users to understand the rationale
										for exactly what they see in the GUI.

										<li> in Cylc 7 task pool bloat is the major performance
										limiting factor in huge suites. Runahead limiting only
										limits the task pool across cycles, not within a cycle.
										Queue limiting limits active tasks (which protects external
										resources) but not the internal task pool.
								 </ul>
								 <p>
										Cylc 8: task pool size 3!! (actually the blue waiting task
										would not even be there unless it has a pre-success
										dependence on the upstream tasks and was held back by for
										external (non-graph) reasons.
										</p>

							<p>
							this is a massive step forward because even huge suites typically
							have much smaller number tasks active at any given time.
							</p>

							</aside>
					 </section>

					 <section>
							 <!--
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/n-dist-1.svg"/>
							</div>
							-->
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/n-dist-2.svg"/>
							</div>
							<div class="fragment" style="width:100%; position:absolute; left:0; top:0; background:white"/>
								 <img src="hjo/media/n-dist-3.svg"/>
							</div>
							<div class="fragment" style="width:100%; position:absolute; left:0; top:0; background:white"/>
								 <img src="hjo/media/n-dist-4.svg"/>
							</div>
							<div class="fragment" style="width:100%; position:absolute; left:0; top:0; background:white"/>
								 <img src="hjo/media/n-dist-5.svg"/>
							</div>
							<aside class="notes">
								 Spawn on demand also allows us to make a sensible graph-based
								 window on the workflow
								 <ul>
										 <li>
									- n=0 (active): submitted, running, (or unhandled-failed)
									<li>
									- n=1: what comes next, including ready-but-held-back tasks
									<li>
									- makes graph view useful even in very large suites
									<li>
									- the rationale behind what you see in the UI makes sense
							</aside>
					 </section>

					 <section>
							<div style="width:100%; position:absolute; left:0; top:0"/>
								 <img src="hjo/media/suicide.png"/>
							</div>
							<aside class="notes">
									Another benefit of spawn on demand: no suicide triggers for
									graph branching.

									So here's your classic failure recovery branching scenario...
							</aside>
					 </section>
	
					 <section>
						<pre><code class="ini">[scheduling]  # Cylc 7
   cycling mode = integer
   initial cycle point = 1
   [[dependencies]]
      [[[P1]]]
         graph = """
            pre => model
            model:fail => diagnose => recover
            model | recover => post
            model => !diagnose & !recover  # ???
         """
</code></pre>
</section>
					 <section>
						<pre><code class="ini">[scheduling]  # Cylc 8
   cycling mode = integer
   initial cycle point = 1
   [[graph]]
      P1 = """
         pre => model
         model:fail => diagnose => recover
         model | recover => post
      """
</code></pre>
</section>

					 <!-- ANIM: MUST BE FOLLOWED BY data-state=postanim (PAUSE WORKFLOW) -->
					 <section data-state="anim-2">
					<div style="position:absolute; top:100px; right:0">
							<span style="font-size:50%">Cylc 8: spawn-on-demand</span>
					</div>
							<div id="infinite-cycling-2" style="width:900px; height:700px; border: 1px dashed slategray;">
							</div>
							<span style="font-size:10px; position:absolute; bottom:0; left:0">Credit: Oliver Sanders</span>
							<aside class="notes">
					 </section>

					 <!-- POSTANIM2: PAUSE WORKFLOW ON MOVE TO NEXT SLIDE -->
					 <section data-state="anim-3 postanim-2">
							<div style="position:absolute; top:100px; right:0">
									<span style="font-size:50%">Cylc 8: spawn-on-demand<br/>REFLOW</span>
							</div>
	
							<div id="infinite-cycling-3" style="width:900px; height:700px; border: 1px dashed slategray;">
							</div>
							<span style="font-size:10px; position:absolute; bottom:0; left:0">Credit: Oliver Sanders</span>
							<aside class="notes">
									<p>
									multiple workflow wavefronts, if you like, traveling through
									the infinite graph. A new front can be triggered simply by
									triggering the task or tasks at the head of it.
									</p>
							</aside>
					</section>
			</section>

		 <section>
				 <!-- POSTANIM3: PAUSE WORKFLOW ON MOVE TO NEXT SLIDE -->
				 <section data-state="postanim-3">
						 <h2><span style="color:red">When</span> Cylc 8.0.0?</h2>
				 </section>

				 <section style="font-size:80%">
						 <h4>done already</h4>
						 <ul>
								 <li>Python 3 migration</li>
								 <li>architecture: new components and network layers </li>
								 <li>Hub spawns Cylc UI Servers (JupyterHub!)</li>
								 <li>web UI core (Vue.js) and tree view</li>
								 <li>incremental data update subscriptions</li>
								 <li>spawn-on-demand scheduler</li>
								 <li>secure back-end job authentication (CurveZMQ)</li>
								 <li>packaging via <code>pip</code> and <code>conda</code></li>
								 <li>platforms support</li>
								 <li>suite installation to job platforms</li>
								 <li>many config changes</li>
						 </ul>
				 </section>

				 <section style="font-size:80%">
						 <h4>still to be done</h4>
						 <ul>
								 <li>Cylc UI:
								 <ul>
										 <li>finish UI command integration</li>
										 <li>display non-task entities (xtriggers, queues, ...)</li>
										 <li>new graph view</li>
										 <li>start stopped suites</li>
								 </ul>
								 <li>suite installation and new `cylc run` semantics<br/>
								 (with plugin for `rose-suite.conf` back-compat)</li>
								 <li>finish graph-based windowing (scheduler and UIS)
								 <ul>
										 <li>including loading historical tasks from the DB</li>
								 </ul></li>
								 <li>cross-user access and fine-grained authorization</li>
								 <li>documentation rewrite</li>
								 <li>cylc review (rose bush) fallback?</li>
								 <li>... and a million details</li>
						 </ul>
				 </section>

				 <section style="font-size:80%">
						 <h4>timeline</h4>
						 <p>Behind schedule (team size, pandemic impact, ...) but good
						 progress nonetheless (see previous slides)</p>
						 <br/>
						 <ul>
								 <li> First beta release <code>cylc-8.0b0</code> Jan 2021??
								 <ul>
										 <li>some non-critical features missing (e.g. UI graph view)</li>
										 <li>we will encourage heavy testing at this point</li>
								 </ul></li>
								 <br/>
								 <li> First full release <code>cylc-8.0</code> late Q2 2021?</li>
						 </ul>
						 <aside class="notes">
								 "critical" vs essential! Graph view is essential to Cylc, but
								 not critical - you can run workflows perfectly well without it
								 (in fact in Cylc 7 it is useless for large suites)

								 Perhaps we underestimated the scale of the task too (but in
								 the spin-up period 2 years ago we had anticipated having
								 several more people).

								 Note we are going as fast as we possibly can.
						 </aside>
				 </section>

	
		 </section>

		 <section>

					 <section>
							 <h4>thanks to the Cylc team</h4>
								 <img src="hjo/media/mug-shots.png"/>
								 <br/>
								 <span style="font-size:50%">(plus former team members and
										 contributors too)</span>
					 </section>
		 </section>

		 </div>
	</div>


		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/fullscreen/plugin.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
                hash: true,
								width: 960,
                height: 800,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealFullscreen ],
				transition:'none',
			});
		</script>
		
		<script>
      Reveal.on('beer', event => {
							count_down();
      }, false);


       function count_down() {
					// Set the date we're counting down to
					var countDownDate = new Date().getTime() + 45*60000;
					// Update the count down every 1 second
					var x = setInterval(function() {
									var now = new Date().getTime();
									// Find the distance between now and the count down date
									var d = countDownDate - now;
									// Time calculations for days, hours, minutes and seconds
									var min = Math.floor((d % (1000 * 60 * 60)) / (1000 * 60));
									var sec = Math.floor((d % (1000 * 60)) / 1000);
									// Display the result in the element with id="cdown"
									document.getElementById("cdown").innerHTML = min.toString().padStart(2, "0") + ":" + sec.toString().padStart(2,"0");
									}, 1000);
			}
		</script>

		<script src="hjo/js/minicylc.js"></script>
	  <script type="text/javascript" src="hjo/js/jquery.min.js"></script>

		<script>

      // write dependencies
      const deps = [];
      for (let i=0; i<100; i++) {
        deps.push(`a${i} => c${i} => d${i}`);
        deps.push(`a${i} => b${i}`);
        deps.push(`a${i} => a${i+1}`);
        deps.push(`c${i} => b${i+1}`);
      }

      // create graph
      const infinite_animation = $('<embed style="background:#eaeaea;"/>')
        .addClass('minicylc')
        .data('focus', true)
        .data('randomFactor', 0.5)
        .data('dependencies', deps.join('//'))
        .attr('src', 'hjo/media/infinite-workflow.svg')[0]
      $('#infinite-cycling').append(infinite_animation);

      const infinite_animation_2 = $('<embed style="background:#eaeaea;"/>')
        .addClass('minicylc')
        .data('focus', true)
        .data('randomFactor', 0.5)
        .data('dependencies', deps.join('//'))
				.data('succeed_fill', 'white')
        .attr('src', 'hjo/media/infinite-workflow.svg')[0]
      $('#infinite-cycling-2').append(infinite_animation_2);

      const infinite_animation_3 = $('<embed style="background:#eaeaea;"/>')
        .addClass('minicylc')
        .data('focus', true)
        .data('randomFactor', 0.5)
        .data('dependencies', deps.join('//'))
				.data('succeed_fill', 'white')
				.data('reflow', 'a7')
        .attr('src', 'hjo/media/infinite-workflow.svg')[0]
      $('#infinite-cycling-3').append(infinite_animation_3);


			const infinite_worklow = undefined
			const infinite_worklow_2 = undefined
			const infinite_worklow_3 = undefined

      Reveal.on('anim', event => {
						console.log(event);
						if (typeof infinite_workflow === 'undefined') {
							 infinite_workflow = new MiniCylc(infinite_animation, true);
							 infinite_workflow.run();
						}
						infinite_workflow.release();
      }, false);

      Reveal.on('postanim', event => {
						infinite_workflow.hold();
						}, false);

      Reveal.on('anim-2', event => {
						if (typeof infinite_workflow_2 === 'undefined') {
							 infinite_workflow_2 = new MiniCylc(infinite_animation_2, true);
							 infinite_workflow_2.run();
						}
						infinite_workflow_2.release();
      }, false);

      Reveal.on('postanim-2', event => {
						infinite_workflow_2.hold();
						}, false);

      Reveal.on('anim-3', event => {
						if (typeof infinite_workflow_3 === 'undefined') {
							 infinite_workflow_3 = new MiniCylc(infinite_animation_3, true);
							 infinite_workflow_3.run();
						}
						infinite_workflow_3.release();
						}, false);

      Reveal.on('postanim-3', event => {
						infinite_workflow_3.hold();
						}, false);

     </script>
		
	</body>
</html>
